<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tokat & Yumruk Atma</title>
<style>
:root{
  --bg:#f4f7fb;
  --card:#ffffff;
  --accent:#0b63d6;
  --muted:#6b7280;
}
*{box-sizing:border-box;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
body{
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:linear-gradient(180deg,var(--bg),#e8f0fe);
  padding:24px;
}
.wrap{
  width:100%;
  max-width:880px;
  background:var(--card);
  border-radius:16px;
  padding:28px;
  box-shadow:0 10px 30px rgba(11,99,214,0.08);
  display:grid;
  grid-template-columns: 1fr 340px;
  gap:20px;
  align-items:center;
}
.play-area{
  display:flex;
  flex-direction:column;
  gap:18px;
  align-items:center;
}
.scene{
  width:100%;
  max-width:480px;
  height:280px;
  background:linear-gradient(180deg,#fdfefe,#f0f6ff);
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  overflow:hidden;
  border:1px solid rgba(11,99,214,0.06);
}
.face{
  width:160px;
  height:160px;
  border-radius:50%;
  background: #ffe6d6;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  box-shadow:0 8px 18px rgba(0,0,0,0.08);
  transition: transform 200ms ease;
}
.face.shake{
  animation: shake 340ms ease;
}
@keyframes shake{
  0%{ transform: translateX(0) rotate(0deg); }
  25%{ transform: translateX(-18px) rotate(-12deg); }
  55%{ transform: translateX(12px) rotate(8deg); }
  100%{ transform: translateX(0) rotate(0deg); }
}
.eyes{
  display:flex;
  gap:18px;
}
.eye{
  width:18px;height:18px;border-radius:50%;background:#322;
  box-shadow:inset 0 -3px 0 rgba(0,0,0,0.12);
  transition: background 0.18s, box-shadow 0.18s, transform 0.18s;
  position:relative;
}
.eye::after{
  content:"";
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  top:22px;
  width:36px;
  height:14px;
  background: radial-gradient(circle at 30% 30%, rgba(107,14,14,0.9), rgba(107,14,14,0.6));
  border-radius:8px;
  opacity:0;
  transition: opacity 0.18s, transform 0.18s;
  pointer-events:none;
}
.left-eye::after{ left:50%; }
.right-eye::after{ left:50%; }

.mouth{
  position:absolute; bottom:30px; width:60px; height:16px; border-radius:8px; background:#b64;
  transform-origin:center; transition: transform 120ms;
}
.mouth.big{ transform: scaleX(1.6) scaleY(1.1); height:22px; background:#9a2; }

.face-cheek{
  position:absolute;
  width:50px;
  height:50px;
  border-radius:50%;
  background:rgba(255,80,80,0.5);
  right:15px;
  bottom:35px;
  opacity:0;
  pointer-events:none;
  transition:opacity 0.18s;
}
.face.tokat .face-cheek{ opacity:1; }

.face.yumruk .left-eye{
  background:#6b0e0e;
  box-shadow:0 0 10px rgba(107,14,14,0.45), inset 0 -3px 0 rgba(0,0,0,0.18);
  transform: translateY(1px);
}
.face.yumruk .left-eye::after{ opacity:1; transform: translateX(-50%) translateY(0); }

.face.yumruk .right-eye{
  background:#322;
}
.face.yumruk .right-eye::after{ opacity:0; }

.hand{
  position:absolute;
  right:-140px;
  top:40px;
  width:260px;
  height:260px;
  pointer-events:none;
  transform-origin: right center;
  transition: transform 200ms cubic-bezier(.18,.9,.4,1);
  filter: drop-shadow(0 18px 18px rgba(11,99,214,0.08));
}
.hand.swoosh{
  animation: swoosh 420ms cubic-bezier(.12,.9,.24,1) forwards;
}
@keyframes swoosh{
  0%{ transform: translateX(0) rotate(-20deg); right:-140px; }
  45%{ transform: translateX(-220px) rotate(-20deg); right:40px; }
  70%{ transform: translateX(-200px) rotate(-10deg); }
  100%{ transform: translateX(0) rotate(0deg); right:-140px; }
}
.panel{
  padding:14px;
  border-left:1px dashed rgba(0,0,0,0.03);
  display:flex;
  flex-direction:column;
  gap:12px;
  align-items:stretch;
}
h1{ font-size:20px; margin:0 0 2px 0; color:#07203b; }
p.lead{ margin:0; color:var(--muted); font-size:13px; }
.counter{
  display:flex;
  gap:8px;
  align-items:center;
  justify-content:space-between;
  margin-top:6px;
}
.count-bubble{
  font-size:28px;
  font-weight:700;
  color:var(--accent);
}
.secondary-btn{
  margin-top:8px;
  padding:10px 12px;
  border-radius:10px;
  border:1px solid rgba(0,0,0,0.06);
  background:#fff;
  color:#07203b;
  font-weight:600;
  cursor:pointer;
}
.small{ font-size:13px;color:var(--muted); }
@media (max-width:880px){
  .wrap{ grid-template-columns: 1fr; padding:18px; }
  .panel{ border-left:0; border-top:1px dashed rgba(0,0,0,0.04); padding-top:16px; }
  .hand{ display:none; }
}
</style>
</head>
<body>
<div class="wrap" role="application" aria-label="Tokat & Yumruk UygulamasÄ±">
  <div class="play-area">
    <div class="scene" id="scene" aria-hidden="false">
      <div class="face" id="face" aria-hidden="true">
        <div class="eyes">
          <div class="eye left-eye"></div>
          <div class="eye right-eye"></div>
        </div>
        <div class="mouth" id="mouth"></div>
        <div class="face-cheek"></div>
      </div>
      <svg class="hand" id="hand" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <g transform="translate(0,0) scale(1.2)">
          <path d="M160 40c-2-12-14-18-24-14-6 2-10 6-14 10-4-10-14-18-26-16-10 2-18 10-20 20-6-6-16-8-24-4-10 6-14 18-12 28-10 0-18 8-20 18-4 16 6 32 20 34l84 8c8 0 14-6 16-14 4-12 10-26 6-40-4-16-13-30-12-38z" fill="#f5c7a8"/>
          <rect x="20" y="110" width="120" height="22" rx="10" fill="#f1b892"/>
        </g>
      </svg>
    </div>

    <div style="display:flex;gap:8px;align-items:center;">
      <button class="secondary-btn" id="startSlapBtn">Tokatla BaÅŸla</button>
      <div class="small">Klavye: <strong>Space=Tokat, Enter=Yumruk</strong></div>
    </div>
  </div>

  <aside class="panel" aria-label="Kontroller">
    <div>
      <h1>Tokat/Yumruk SayaÃ§</h1>
      <p class="lead">Her tÄ±klama bir tokat veya yumruk sayÄ±lÄ±r. EÄŸlen ama nazik ol ðŸ˜‰</p>
    </div>

    <div class="counter" aria-live="polite">
      <div>
        <div class="small">Toplam</div>
        <div class="count-bubble" id="count">0</div>
      </div>
      <div style="text-align:right">
        <div class="small">Son AtÄ±ÅŸ</div>
        <div id="lastHit" class="small">â€”</div>
      </div>
    </div>

    <div>
      <div class="small">Ayarlamalar</div>
      <label class="small" style="display:flex;gap:8px;align-items:center;margin-top:8px;">
        <input id="vibrateToggle" type="checkbox" checked /> Mobil titreÅŸim
      </label>
      <label class="small" style="display:flex;gap:8px;align-items:center;margin-top:8px;">
        <input id="faceAnimToggle" type="checkbox" checked /> YÃ¼z animasyonu
      </label>
    </div>

    <div style="margin-top:auto">
      <div class="small">Not: Bu demo tamamen eÄŸlence amaÃ§lÄ±dÄ±r.</div>
    </div>
  </aside>
</div>

<script>
const startSlapBtn = document.getElementById('startSlapBtn');
const countEl = document.getElementById('count');
const lastHitEl = document.getElementById('lastHit');
const handEl = document.getElementById('hand');
const faceEl = document.getElementById('face');
const mouthEl = document.getElementById('mouth');
const vibrateToggle = document.getElementById('vibrateToggle');
const faceAnimToggle = document.getElementById('faceAnimToggle');

let count = 0;
let audioCtx;

function ensureAudio(){
  if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
}

function playSlapSound(intensity = 1){
  try{
    ensureAudio();
    const ctx = audioCtx;
    const bufferSize = Math.floor(ctx.sampleRate*0.09);
    const noiseBuffer = ctx.createBuffer(1,bufferSize,ctx.sampleRate);
    const output = noiseBuffer.getChannelData(0);
    for(let i=0;i<bufferSize;i++){
      const env = 1 - i/bufferSize;
      output[i] = (Math.random()*2-1) * env * 0.9;
    }
    const noiseSrc = ctx.createBufferSource();
    noiseSrc.buffer = noiseBuffer;
    const noiseFilter = ctx.createBiquadFilter();
    noiseFilter.type = 'bandpass';
    noiseFilter.frequency.value = 1500 + Math.random()*900;
    noiseFilter.Q.value = 0.7;

    const noiseGain = ctx.createGain();
    noiseGain.gain.value = 0.6 * Math.min(1.8, intensity);

    noiseSrc.connect(noiseFilter);
    noiseFilter.connect(noiseGain);

    const osc = ctx.createOscillator();
    osc.type = 'sine';
    osc.frequency.value = intensity > 1.2 ? 90 : 120;
    const oscGain = ctx.createGain();
    const now = ctx.currentTime;
    oscGain.gain.setValueAtTime(0.0001, now);
    oscGain.gain.exponentialRampToValueAtTime(0.45 * intensity, now + 0.005);
    oscGain.gain.exponentialRampToValueAtTime(0.001, now + 0.16);

    osc.connect(oscGain);
    oscGain.connect(noiseGain);

    const master = ctx.createGain();
    master.gain.value = 0.95;
    noiseGain.connect(master);
    master.connect(ctx.destination);

    noiseSrc.start();
    osc.start();
    noiseSrc.stop(ctx.currentTime + 0.10);
    osc.stop(ctx.currentTime + 0.18);
  }catch(e){ console.warn('Audio error', e); }
}

function doSlap(source='mouse', type='tokat'){
  count++;
  countEl.textContent = count;
  lastHitEl.textContent = `${type} â€” ${source} â€” ${new Date().toLocaleTimeString()}`;

  handEl.classList.remove('swoosh');
  void handEl.offsetWidth;
  handEl.classList.add('swoosh');

  if(faceAnimToggle.checked){
    faceEl.classList.remove('shake','tokat','yumruk');
    void faceEl.offsetWidth;

    if(type === 'tokat'){
      faceEl.classList.add('tokat','shake');
      mouthEl.classList.add('big');
      setTimeout(()=> mouthEl.classList.remove('big'), 260);
      setTimeout(()=> faceEl.classList.remove('tokat'), 420);
    } else if(type === 'yumruk'){
      faceEl.classList.add('yumruk','shake');
      mouthEl.classList.add('big');
      setTimeout(()=> mouthEl.classList.remove('big'), 260);
      setTimeout(()=> faceEl.classList.remove('yumruk'), 1200);
    }
  }

  const baseIntensity = type === 'yumruk' ? 1.4 : 1.0;
  const intensity = Math.min(2.0, baseIntensity + Math.log(1 + count)/8);
  playSlapSound(intensity);

  if(vibrateToggle.checked && navigator.vibrate){
    navigator.vibrate(type === 'yumruk' ? [60,30,60] : [20,10,30]);
  }
}

/* Start button: bir tokat atar ve sonra kendi kendini gizler */
startSlapBtn.addEventListener('click', ()=>{
  ensureAudio();
  if(audioCtx.state === 'suspended') audioCtx.resume();
  doSlap('baÅŸlatÄ±cÄ±','tokat');
  startSlapBtn.style.display = 'none';
});

/* Klavye kontrolleri: sadece space ve enter */
window.addEventListener('keydown', (e)=>{
  if(e.code === 'Space'){
    e.preventDefault();
    doSlap('klavye','tokat');
  } else if(e.code === 'Enter'){
    e.preventDefault();
    doSlap('klavye','yumruk');
  }
});
</script>
</body>
</html>
